package com.zallek.collide.game.dialog;

import org.andengine.engine.camera.Camera;
import org.andengine.entity.sprite.ButtonSprite;
import org.andengine.entity.sprite.ButtonSprite.OnClickListener;
import org.andengine.entity.text.Text;
import org.andengine.entity.text.TextOptions;
import org.andengine.opengl.vbo.VertexBufferObjectManager;
import org.andengine.util.adt.align.HorizontalAlign;

import com.zallek.collide.manager.ResourcesManager;
import com.zallek.collide.scene.GameScene;

public class QuitDialog extends GameDialog {

	private GameScene scene;
	
	public QuitDialog(GameScene scene, Camera camera, VertexBufferObjectManager pSpriteVertexBufferObject) {
		super(scene, camera, pSpriteVertexBufferObject);
		this.scene = scene;
		
		attach_text(pSpriteVertexBufferObject);
		attach_buttons(pSpriteVertexBufferObject);
	}

	private void attach_text(VertexBufferObjectManager vbom){
    	Text confirmText = new Text(200, 175, ResourcesManager.getInstance().font, "Are you sure ?", new TextOptions(HorizontalAlign.CENTER), vbom);
    	attachChild(confirmText);
    }
	
	private void attach_buttons(VertexBufferObjectManager vbom){
		final ButtonSprite accept_button = new ButtonSprite(250, 100, ResourcesManager.getInstance().accept_button_region, vbom);
		accept_button.setOnClickListener(setAcceptButtonListener());
        scene.registerTouchArea(accept_button);
        this.attachChild(accept_button);
        
        final ButtonSprite cancel_button = new ButtonSprite(150, 100, ResourcesManager.getInstance().cancel_button_region, vbom);
        cancel_button.setOnClickListener(setCancelButtonListener());
        scene.registerTouchArea(cancel_button);
        this.attachChild(cancel_button);
    }
	
	private OnClickListener setAcceptButtonListener() {
		return new OnClickListener() {
			
			@Override
			public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {
				scene.backToMenu();
			}
		};
	}
	
	private OnClickListener setCancelButtonListener() {
		return new OnClickListener() {
			
			@Override
			public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {
				setVisible(false);
			}
		};
	}
}
